//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated from a template.
//
//     Manual changes to this file may cause unexpected behavior in your application.
//     Manual changes to this file will be overwritten if the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

namespace PantryParty.Models
{
    using System;
    using System.Collections.Generic;
    using System.Linq;

    public partial class UserIngredient
    {
        public string UserID { get; set; }
        public string IngredientID { get; set; }
        public int keyvalue { get; set; }
    
        public virtual AspNetUser AspNetUser { get; set; }
        public virtual Ingredient Ingredient { get; set; }

        public static List<AspNetUser> FindUsersWith(List<Ingredient> RecipeIngredients, List<Ingredient> UserIngredients)
        {
            pantrypartyEntities ORM = new pantrypartyEntities();
            List<UserIngredient> UIList = new List<UserIngredient>();
            List<AspNetUser> ToReturn = new List<AspNetUser>();

            foreach (var ing in UserIngredients)
            {
                if (RecipeIngredients.Contains(ing))
                {
                    RecipeIngredients.Remove(ing);
                }
            }

            foreach (var ing in RecipeIngredients)
            {
                UIList = ORM.UserIngredients.Where(x => x.IngredientID == ing.Name).ToList();

                if (UIList == null)
                {
                    continue;
                }
                foreach (var item in UIList)
                {
                    ToReturn.AddRange(ORM.AspNetUsers.Where(x => x.ID == item.UserID).ToList());
                }
            }
            ToReturn.Distinct<AspNetUser>().ToList();
            return ToReturn;
        }
    }
}
